<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Kaiten Translations</title>
  <script>
    // –ó–∞–≥—Ä—É–∂–∞–µ–º SDK Kaiten
    (function() {
      const script = document.createElement('script');
      script.src = 'https://files.kaiten.ru/web-sdk/v1.min.js';
      script.onload = initAddon;
      script.onerror = function() {
        console.error('Failed to load Kaiten SDK');
      };
      document.head.appendChild(script);
      
      function initAddon() {
        if (window.Addon) {
          try {
            window.Addon.initialize({
              card_buttons: function(context) {
                return [{
                  text: 'üåê –ü–µ—Ä–µ–≤–æ–¥—ã',
                  callback: function(callbackContext) {
                    const url = window.location.origin + '/translations';
                    console.log('Opening URL:', url);
                    
                    try {
                      // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥ Kaiten
                      if (callbackContext && typeof callbackContext.openIframe === 'function') {
                        callbackContext.openIframe(url);
                        console.log('Opened via openIframe method');
                      } 
                      // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥
                      else if (window.parent && typeof window.parent.postMessage === 'function') {
                        window.parent.postMessage({
                          type: 'kaiten-iframe-open',
                          url: url
                        }, '*');
                        console.log('Opened via postMessage');
                      }
                      else {
                        console.error('No available method to open iframe');
                      }
                    } catch (e) {
                      console.error('Error opening iframe:', e);
                    }
                  }
                }];
              }
            });
            console.log('‚úÖ Kaiten addon initialized successfully');
          } catch (e) {
            console.error('‚ùå Addon initialization error:', e);
          }
        } else {
          console.error('‚ùå Kaiten SDK not available');
        }
      }
    })();
  </script>
  <style>
    body { 
      background: transparent; 
      margin: 0; 
      padding: 0; 
    }
  </style>
</head>
<body>
  <script>
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
    window.addEventListener('message', function(event) {
      console.log('Message received:', event.data);
    });
    
    // –õ–æ–≥–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –æ–∫—Ä—É–∂–µ–Ω–∏–∏
    console.log('Kaiten Translations Addon loaded');
    console.log('Origin:', window.location.origin);
    console.log('Parent window:', window.parent === window ? 'self' : 'different');
  </script>
</body>
</html>
